<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="google" value="notranslate" />

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
	<link rel="stylesheet" th:href="@{/css/allCss.css}">
	<link rel="stylesheet" th:href="@{/css/myPage.css}">
	<link rel="stylesheet" th:href="@{/css/hamburger.css}" />
	<link rel="icon" href="/img/realLogo.png">
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
	<link rel="stylesheet" type="text/css"
		  th:href="@{https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css}" />
	<title>My Page</title>
</head>

<body>
<div class="wrapper">
	<div class="welcome">
		<p th:text="${session.memberNick} + 'ë‹˜, Mini Game Worldì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤.ğŸ±â€ğŸ‰'"></p>
	</div>
	<div class="header">
		<!-- í–„ë²„ê±° ë²„íŠ¼ ë„ì „ êµ¬ì—­ ì‹œì‘ -->
		<nav role="navigation">
			<div id="menuToggle">
				<!-- í–„ë²„ê±° ëª¨ì–‘ -->
				<input type="checkbox" />
				<div class="burger">
					<span></span>
					<span></span>
					<span></span>
				</div>

				<ul id="menu">
					<a th:href="@{/main}">
						<li>Home</li>
					</a>
					<a th:href="@{/boardList}">
						<li>Community</li>
					</a>
					<a th:href="@{/myPage}">
						<li>My Page</li>
					</a>
					<a th:href="@{/QnAPage}">
						<li>Q&A</li>
					</a>
					<a th:href="@{/aboutUs}">
						<li>About Us</li>
					</a>
				</ul>
			</div>
		</nav>
		<!-- í–„ë²„ê±° ë²„íŠ¼ ë„ì „ êµ¬ì—­ ë -->

		<div class="logo">
			<a th:href="@{/main}"><img class="logoImg" th:src="@{/img/logo.png}" alt=""></a>
		</div>
		<div class="top-nav">
			<ul class="top-nav-ul">
				<li class="top-nav-li"><a th:href="@{/main}">Home</a></li>
				<li class="top-nav-li"><a th:href="@{/boardList}">Community</a></li>
				<li class="top-nav-li"><a th:href="@{/myPage}">My Page</a></li>
				<li class="top-nav-li"><a th:href="@{/QnAPage}">Q&A</a></li>
				<li class="top-nav-li"><a th:href="@{/aboutUs}">About Us</a></li>
				<li class="drop-top-nav-li"><a href="#">Account</a>
					<ul class="drop-ul">
						<li><a th:href="@{/logout}" onclick="logout(event)">logout</a></li>
						<li><a href="#"><img class="imgicon" th:src="@{/img/ì„¤ì •.png}">ì„¤ì •</a></li>
					</ul>
				</li>
			</ul>
		</div>
	</div>

	<div class="container">
		<ul class="tabs">
			<li class="tab-link current" data-tab="tab-1">ë‚´ ì •ë³´</li>
			<li class="tab-link" data-tab="tab-2">ë‚´ê°€ ì“´ ê¸€ ëª©ë¡</li>
		</ul>
		<div id="tab-1" class="tab-content current">
			<div class="profile">
				<div class="profile-picture">
					<p class="top-text">í”„ë¡œí•„ ì‚¬ì§„</p>
					<div class="photo">
						<img src="/img/ì»¤ë¹„.jpg" alt="">
					</div>
					<p class="bottom-text">ë‹‰ë„¤ì„: <span th:text="${authInfo.getMemberNick()}" /></p>
				</div>
				<div class="profile-info">
					<p class="id">ì•„ì´ë””: <span th:text="${authInfo.getMemberId()}" /></p>
					<p class="name">ì´ë¦„: <span th:text="${authInfo.getMemberName()}" /></p>
					<p class="email">ì´ë©”ì¼: <span th:text="${authInfo.getMemberEmail()}" /></p>
					<button style="margin-right: 47.7px;" class="btn btn--stripe right"
							onclick="openPasswordConfirmPopup()">ìˆ˜ì • í•˜ëŸ¬ ê°€ê¸°</button>
				</div>
			</div>
		</div>
	</div>
	<div id="tab-2" class="tab-content">
		<table class="board-table">
			<thead>
			<tr>
				<th scope="col" class="th-title">ì œëª©</th>
				<th scope="col" class="th-date">ë“±ë¡ì¼</th>
			</tr>
			</thead>
			<tbody>
			<!-- ê²Œì‹œë¬¼ ëª©ë¡ì„ ë°˜ë³µë¬¸ìœ¼ë¡œ ì¶œë ¥ -->
			<tr th:each="board : ${myBoards}">
				<td> <a th:href="@{/boardDetail(board_idx=${board.board_idx})}"
						th:text="${board.boardTitle}"></a></td>
				<td th:text="${board.CREATED_AT}"></td>
			</tr>
			</tbody>
		</table>
		<!-- í˜ì´ì§• ë²„íŠ¼ í‘œì‹œ -->
		<div class="pagination">
			<ul>
<!--				<li class="page-item" th:if="${pageNumber > 1}">-->
<!--					<a class="page-link paging-btn" th:href="@{/myPage(page=${pageNumber - 1})}">-->
<!--						<< </a>-->
<!--				</li>-->

				<th:block th:with="startPage=${((pageNumber - 1) / 5) * 5 + 1}">
					<li class="page-item" th:if="${startPage > 1}">
						<a class="page-link paging-btn" th:href="@{/myPage(page=${startPage - 1})}">
							< </a>
					</li>

					<th:block
							th:each="page : ${#numbers.sequence(startPage, (startPage + 4) < totalPages ? (startPage + 4) : totalPages)}">
						<li class="page-item" th:class="${page == pageNumber} ? 'active' : ''">
							<a class="page-link paging-btn" th:href="@{/myPage(page=${page})}"
							   th:text="${page}"></a>
						</li>
					</th:block>

					<li class="page-item" th:if="${(startPage + 4) < totalPages}">
						<a class="page-link paging-btn" th:href="@{/myPage(page=${startPage + 5})}">></a>
					</li>
				</th:block>

<!--				<li class="page-item" th:if="${pageNumber < totalPages}">-->
<!--					<a class="page-link paging-btn" th:href="@{/myPage(page=${pageNumber + 1})}">>></a>-->
<!--				</li>-->
			</ul>
		</div>

	</div>

</div>
<div class="footer">
	<div class="footer-text">
		<p>íšŒì‚¬ì •ë³´ <br>
			ìƒí˜¸ : ê·¸ë¦° ì»´í“¨í„° <br>
			ì£¼ì†Œ : ê²½ê¸°ë„ ìˆ˜ì›ì‹œ <br>
			ê°œì¸ì •ë³´ê´€ë¦¬ ì±…ì„ì : ê¹€ê·¸ë¦° (Team2EmailService@gmail.com) <br>
			ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸ : 111-11-1111
		</p>
		<p>
			íšŒì‚¬ì†Œê°œ | ì‡¼í•‘ê°€ì´ë“œ | ê°œì¸ì •ë³´ë³´í˜¸ì •ì±… | ì´ìš©ì•½ê´€
		</p>
	</div>
	<div class="footers">
		<div class="footer-cs">
			<p>
				ê·¼ë¬´ì‹œê°„ : ì›” ~ ê¸ˆ AM 9:00 ~ PM 7:00 <br>
				ì ì‹¬ì‹œê°„ : PM12 :00 ~ PM 1 : 00 <br>
				ê³ ê°ì„¼í„° : AM 10: 00 ~ PM6 : 00
			</p>
		</div>
		<div class="ours">
			<p>ëª¨ë“  ì €ì‘ê¶Œì€ 2íŒ€ì—ê²Œ ìˆìŠµë‹ˆë‹¤. <br>
				Copyright 2023. 2íŒ€ <br>
				All rights reserved.
			</p>
		</div>
	</div>
</div> <!-- footer ë -->
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script>
	$(document).ready(function () {

		$('ul.tabs li').click(function () {
			var tab_id = $(this).attr('data-tab');

			$('ul.tabs li').removeClass('current');
			$('.tab-content').removeClass('current');

			$(this).addClass('current');
			$("#" + tab_id).addClass('current');
		})

	})

	//ìˆ˜ì •í•˜ê¸° ë²„íŠ¼ ëˆ„ë¥´ë©´ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ìœ¼ë¡œ ë°”ê¿”ì„œ ì£¼ì„ì²˜ë¦¬
	// function openMyPageUpdate() {
	// 	window.location.href = "/myPageUpdateForm";
	// }
	// function openPasswordConfirmPopup() {
	// 	$("<div>").dialog({
	// 		title: "ë¹„ë°€ë²ˆí˜¸ í™•ì¸",
	// 		modal: true,
	// 		buttons: {
	// 			"í™•ì¸": function() {
	// 				var password = $("#password").val();
	// 				if (password !== "") {
	// 					// ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ìš”ì²­ ë³´ë‚´ê¸°
	// 					$.ajax({
	// 						url: "/confirmPassword",
	// 						type: "POST",
	// 						data: { password: password },
	// 						success: function () {
	// 							// ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì„±ê³µ ì‹œ ì—…ë°ì´íŠ¸ í¼ìœ¼ë¡œ ì´ë™
	// 							window.location.href = "/myPageUpdateForm";
	// 						},
	// 						error: function (xhr, status, error) {
	// 							// ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
	// 							var errorMessage = xhr.responseText || "ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤";
	// 							alert(errorMessage);
	// 						}
	// 					});
	// 					$(this).dialog("close");
	// 				}
	// 			},
	// 			"ì·¨ì†Œ": function() {
	// 				$(this).dialog("close");
	// 			}
	// 		},
	// 		close: function() {
	// 			$(this).dialog("destroy").remove();
	// 		}
	// 	}).append(
	// 			$("<label>").text("ë¹„ë°€ë²ˆí˜¸:"),
	// 			$("<input>").attr("type", "password").attr("id", "password")
	// 	);
	// }
	function openPasswordConfirmPopup() {
		$("<div>").dialog({
			title: "ë¹„ë°€ë²ˆí˜¸ í™•ì¸",
			modal: true,
			buttons: {
				"í™•ì¸": function () {
					var password = $("#password").val();
					if (password !== "") {
						// ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ìš”ì²­ ë³´ë‚´ê¸°
						$.ajax({
							url: "/confirmPassword",
							type: "POST",
							data: { password: password },
							success: function () {
								// ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì„±ê³µ ì‹œ ì—…ë°ì´íŠ¸ í¼ìœ¼ë¡œ ì´ë™
								window.location.href = "/myPageUpdateForm";
							},
							error: function (xhr) {
								// ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
								var errorMessage = xhr.responseText || "ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤";
								$("<div>").text(errorMessage).dialog({
									title: "ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì‹¤íŒ¨",
									modal: true,
									buttons: {
										"í™•ì¸": function () {
											$(this).dialog("close");
										}
									},
									close: function () {
										$(this).dialog("destroy").remove();
									}
								});
							}
						});
						$(this).dialog("close");
					}
				},
				"ì·¨ì†Œ": function () {
					$(this).dialog("close");
				}
			},
			close: function () {
				$(this).dialog("destroy").remove();
			}
		}).append(
				$("<label>").text("ë¹„ë°€ë²ˆí˜¸:"),
				$("<input>").attr("type", "password").attr("id", "password")
		);
	}

	//     ë¡œê·¸ì•„ì›ƒ
	function logout(event) {
		event.preventDefault(); // ê¸°ë³¸ ë™ì‘ ë°©ì§€

		const confirmed = confirm("ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?");
		if (confirmed) {
			// ì„œë²„ë¡œ ë¡œê·¸ì•„ì›ƒ ìš”ì²­ì„ ë³´ë‚´ëŠ” Ajax ìš”ì²­ ë“±ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
			// ì„¸ì…˜ì„ ì‚­ì œí•˜ëŠ” ì‘ì—…ì€ ì„œë²„ ì¸¡ì—ì„œ ì²˜ë¦¬ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

			// ì„¸ì…˜ ì‚­ì œ í›„ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
			window.location.href = "/logout";
		}
	}
	$(document).ready(function () {
		// í˜ì´ì§€ ë¡œë“œ ì‹œ íƒ­ ì„¤ì •
		var activeTab = sessionStorage.getItem('activeTab');
		if (activeTab === null) {
			activeTab = 'tab-1'; // ê¸°ë³¸ íƒ­ ì„¤ì •
		}
		$('ul.tabs li').removeClass('current');
		$('.tab-content').removeClass('current');
		$('ul.tabs li[data-tab="' + activeTab + '"]').addClass('current');
		$('#' + activeTab).addClass('current');

		// íƒ­ í´ë¦­ ì‹œ sessionStorageì— í™œì„± íƒ­ ì •ë³´ ì €ì¥
		$('ul.tabs li').on('click', function () {
			var tab_id = $(this).attr('data-tab');
			sessionStorage.setItem('activeTab', tab_id);

			$('ul.tabs li').removeClass('current');
			$('.tab-content').removeClass('current');
			$(this).addClass('current');
			$("#" + tab_id).addClass('current');
		});
	});
</script>
</body>

</html>